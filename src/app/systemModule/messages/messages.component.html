<app-preloader *ngIf="isLoading"></app-preloader>
<section class="second-router-outlet" [ngStyle]="{'display': isLoading?'none':'block'}">
    <div class="messages-main-wrapp">
        <div class="main-mw">
            <div class="flex-massages-wrapp" style="position:relative;">


                
                    <div *ngIf="messages.length<=0" class="empty-info">
                        <img src="./../../../assets/img/smile.svg" class="img-responsive" alt="">
                        <p>Tou have not messages yet</p>
                        
                    </div>
               
                
                    <div class="left-s">
                        <!--задаем класс active при клике-->
                        <ng-container *ngFor="let item of messages; let i = index">
                            <div *ngIf="item.message_type != 'blank'" [ngClass]="{'active':item.id==idCurMsg}" (click)="changeItem(item,i);" class="one-msg-l-block active">
                                <div class="name-ava">
                                    <div class="ava" [ngStyle]="{'background-image': (accs[i]&&accs[i].image_base64_not_given)?'url('+accs[i].image_base64_not_given+')':''}"></div>
                                    <p class="n">{{accs[i]?accs[i].display_name:''}}</p>
                                    <p class="hash"><span>@</span>{{accs[i]?accs[i].user_name:''}}</p>
                                </div>
                                <div  class="descr-side">
                                    <p class="f">
                                        <!--задаем класс active если нужен кружочек. нахуй он всрался - хз-->
                                        <span [ngClass]="{'active':!item.is_read}" class="some-t active">{{item.message_type}} to Perform</span>
                                        <span class="when">{{item.created_at | date:'MMM d' }}</span>
                                    </p>
                                    <p class="name-e">{{item.message_info.event_info.name}}</p>
                                    <p  class="where-when">
                                            {{item.message_info.event_info.address}}
                                        <br>
                                        {{item.message_info.event_info.event_season | titlecase}} {{item.message_info.event_info.event_year}}

                                    </p>
                                    
                                    <p *ngIf="item.message_type == 'request'" class="price">${{item.message_info.estimated_price}}</p>
                                    <p *ngIf="item.message_type == 'accept'" class="price">${{item.message_info.price }}</p>
                                    <p *ngIf="isExpiresSoon(item.created_at, item.message_info.time_frame)=='soon'&&item.message_type == 'request'" class="expires-soon">Expires<br>Soon</p>
                                </div>
                            </div>

                            <div *ngIf="item.message_type == 'blank'" [ngClass]="{'active':item.id==idCurMsg}" (click)="changeItem(item,i);" class="one-msg-l-block active">
                                <div class="name-ava">
                                    <div class="ava" [ngStyle]="{'background-image': (accs[i]&&accs[i].image_base64_not_given)?'url('+accs[i].image_base64_not_given+')':''}"></div>
                                    <p class="n">{{accs[i]?accs[i].display_name:''}}</p>
                                    <p class="hash"><span>@</span>{{accs[i]?accs[i].user_name:''}}</p>
                                </div>
                                <div  class="descr-side">
                                    <p class="f">
                                        <!--задаем класс active если нужен кружочек. нахуй он всрался - хз-->
                                        <span [ngClass]="{'active':!item.is_read}" class="some-t active">{{item.name}}</span>
                                        <span class="when">{{item.created_at | date:'MMM d' }}</span>
                                    </p>
                                    <!-- <p class="name-e">{{item.name}}</p> -->
                                    <!-- <p  class="where-when">
                                            {{item.message_info.event_info.address}}
                                        <br>
                                        {{item.message_info.event_info.event_season | titlecase}} {{item.message_info.event_info.event_year}}

                                    </p> -->
                                
                                </div>
                            </div>












                        </ng-container>
                        
                    </div>


                    <!--вместо дива может быть форма-->
                    <div *ngIf="openMessage.message_type != 'blank'" class="right-s">
                        <div *ngIf="openMessage.id" class="some-request-text-wrapper">
                            <div class="block-info f-b">
                                <span class="some-t">{{openMessage.message_type}} to Perform</span>
                                <span class="when">{{openMessage.created_at | date:'MMM d' }}</span>
                            </div>
                            <div class="block-info s-b">
                                <div class="ava" style="background-image: url(../../assets/img/drake.jpg)"></div>
                                <div class="name-hash">
                                    <p class="n">{{accOpen.display_name?accOpen.display_name:''}}</p>
                                    <p class="hash"><span>@</span>papapa</p>
                                </div>
                                
                            </div>
                            <div class="block-info t-b">
                                <p class="name-event">{{openMessage.message_info.event_info.name}}</p>
                                <p class="descr">{{openMessage.message_info.event_info.description | titlecase}}</p>
                                <p *ngIf="openMessage.message_type == 'request'" class="fot-edit">{{openMessage.message_info.event_info.event_season | titlecase}} {{openMessage.message_info.event_info.event_year}}, {{openMessage.message_info.event_info.event_time | titlecase}}, {{openMessage.message_info.event_info.event_length}} Hours
                                    <img  src="../../assets/img/edit-img.png"  class="img-responsive for-edit-img" alt="">
                                </p>
                                <input *ngIf="openMessage.message_type == 'request'" class="form-control" #drp="bsDaterangepicker" bsDaterangepicker [bsConfig]="bsConfig" 
                                [minDate]="minDate" [maxDate]="maxDate" [(ngModel)]="bsRangeValue">

                                <p *ngIf="openMessage.message_type == 'accept'" class="fot-edit">{{openMessage.message_info.preferred_date_from | date}} - {{openMessage.message_info.preferred_date_to | date}} </p>
                                
                                <!--появлется если нажать на верхнюю картинку for-edit-img-->
                                <!-- <div *ngIf="isEditShow" class="selects-wrapper">
                                    <div class="flex-input-groupes">
                                        <div class="input-groupe-1">
                                            <select [(ngModel)]="openMessage.message_info.event_info.event_season" id="inp-create-5">
                                                <option>spring</option>
                                                <option>summer</option>
                                                <option>autumn</option>
                                                <option>winter</option>
                                        
                                            </select>
                                            <label for="inp-create-5">Event Date</label>
                                        </div>
                                        <div class="input-groupe-1">
                                            <select id="inp-create-6">
                                                <option>2018</option>
                                                <option>2019</option>
                                                <option>2020</option>
                                                <option>2021</option>
                                                <option>2022</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="flex-input-groupes">
                                        <div class="input-groupe-1">
                                            <select id="inp-create-7">
                                                <option>morning</option>
                                                <option>afternoon</option>
                                                <option>evening</option>
                                            </select>
                                            <label for="inp-create-7">Time Range</label>
                                        </div>
                                        <div class="input-groupe-1">
                                            <select id="inp-create-8">
                                                <option>1</option>
                                                <option>2</option>
                                                <option>3</option>
                                                <option>4</option>
                                                <option>5</option>

                                            </select>
                                            <label for="inp-create-8">Event Length</label>
                                        </div>
                                    </div>
                                </div> -->
                                <!--/появлется если нажать на верхнюю картинку for-edit-img-->
                                
                                
                                
                                <p *ngIf="openMessage.message_type == 'request'" class="desc-for-edit">(You can pick the dates you are available to perform)</p>
                                <p *ngIf="openMessage.message_info.event_info.is_crowdfunding_event" class="event-type">Crowdfunded Event</p>
                            </div>
                            <div class="block-info fourth-b">
                                <p class="fot-edit">
                                        
                                    Price to Perform <span> ${{(openMessage.message_type == 'request')?openMessage.message_info.estimated_price:openMessage.message_info.price}}</span>
                                    <img *ngIf="openMessage.message_type == 'request'" src="../../assets/img/edit-img.png" (click)="isEditPrice = true" class="img-responsive for-edit-img" alt="">
                                </p>
                                
                                
                                <!--поялвляется если нажать на картинку "for-edit-img"-->
                                <div *ngIf="isEditPrice" class="flex-price-change">
                                    <p class="your-price">Change price</p>
                                    <div class="rel-dog">
                                        <span>$</span>
                                        <input [(ngModel)]="changePrice" class="inp-style-2" type="text">
                                    </div>
                                </div>
                                <!--/поялвляется если нажать на картинку "for-edit-img"-->
                                
                                
                                <p *ngIf="openMessage.message_type == 'request'" class="desc-for-edit">You can change the Price to Perform</p>
                            </div>
                            <div *ngIf="openMessage.message_type == 'request'" class="block-info fifth-b">
                                <p  class="will-expire">This request will expire on {{ getExpireDate(openMessage.created_at, openMessage.message_info.time_frame) | date }}</p>
                            </div>
                            <div class="block-info sixth-b">
                                <div  *ngIf="openMessage.message_type == 'request'" class="input-groupe-1 whithout-label small-textarea max-500">
                                    <textarea disabled [value]="openMessage.message_info.message"  id="inp-media-venue-2"></textarea>
                                    <label for="inp-media-venue-2" class="head-groupe">Personal Message</label>
                                </div>
                                <div *ngIf="!openMessage.is_read&&openMessage.message_type == 'request'" class="flex-buttons">
                                    <div class="accept-wr">
                                        <button class="butt-style-1" type="submit">
                                            <span (click)="acceptRequest()">Accept</span>
                                        </button>
                                    </div>
                                    <div class="decline-wr">
                                        <button (click)="declineRequest()" class="decline">
                                            <span>Decline</span>
                                        </button>
                                    </div>
                                </div>
                                <div *ngIf="openMessage.message_type == 'accept'" class="flex-buttons">
                                        <div class="accept-wr">
                                            <button [routerLink]="['/system','eventCreate',openMessage.message_info.event_info.id]" class="butt-style-1" type="submit">
                                                <span>Go to Event</span>
                                            </button>
                                        </div>
                                        
                                </div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="openMessage.message_type == 'blank'" class="right-s">
                        <div *ngIf="openMessage.id" class="some-request-text-wrapper">
                            <div class="block-info f-b">
                                <span class="some-t">{{openMessage.name}}</span>
                                <span class="when">{{openMessage.created_at | date:'MMM d' }}</span>
                            </div>
                            <div class="block-info s-b">
                                <div class="ava" style="background-image: url(../../assets/img/drake.jpg)"></div>
                                <div class="name-hash">
                                    <p class="n">{{accOpen.display_name?accOpen.display_name:''}}</p>
                                    <p class="hash"><span>@</span>papapa</p>
                                </div>
                                
                            </div>
                            <div class="block-info t-b">
                                <p class="descr">{{openMessage.simple_message | titlecase}}</p>
                                
                            </div>
                        </div>
                    </div>
               
            </div>
        </div>
    </div>
</section>


<div class="modal fade modal-slider" id="modal-slider">
    <div class="modal-dialog">
        <div class="modal-body">
            <div class="rel-modal">
                <div class="close-modal" data-dismiss="modal"></div>
                <div class="slider-padd">
                    <div class="slider-modal-wr">
                        <div class="one-slide">
                            <h4><span>Share</span> shows you like <span>with friends</span></h4>
                        </div>
                        <div class="one-slide">
                            <h4>Watch shows in <span>360°</span> virtual reality devices</h4>
                        </div>
                        <div class="one-slide">
                            <h4>Crowdfund <span>shows</span> of your favorite artists <span>in your hometown</span></h4>
                        </div>
                    </div>
                </div>
                <div class="flex-buttons-modal">
                    <div class="one-butt-wr">
                        <div class="style-b-op">
                            <span data-dismiss="modal">Sign up later</span>
                        </div>
                    </div>
                    <div class="one-butt-wr">
                        <div class="style-b-op">
                            <a href="#">Sign up</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>